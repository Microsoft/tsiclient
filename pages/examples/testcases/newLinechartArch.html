
<!DOCTYPE html> 
<html>
    <head>
        <title>Basic Charts</title>

        <!-- boilerplate headers are injected with head.js, grab them from the live example header, or include a link to head.js -->
        <script src="../boilerplate/head.js"></script>
    </head>
    <body style="font-family: 'Segoe UI', sans-serif;">
        <div id="chart1" style="width: 100%; height: 600px;"></div>
    
        <script>
            window.onload = function() {
                // create fake data in the shape our charts expect
                var data = [];
                var from = new Date(Math.floor((new Date()).valueOf() / (1000*60 * 60)) * (1000*60 * 60));
                var to;
                for(var i = 0; i < 3; i++){
                    var lines = {};
                    data.push({[`Factory${i}`]: lines});
                    for(var j = 0; j < 5; j++){
                        var values = {};
                        lines[`Station${j}`] = values;
                        for(var k = 0; k < 60; k++){
                            if (i % 2 === 0) {
                                // if(!(k%2 && k%3)){  // if check is to create some sparseness in the data
                                    var to = new Date(from.valueOf() + 1000*60*k);
                                    var val = Math.random() + (j !== 4 ? 2 : 0);
                                    var val2 = Math.random();
                                    var val3 = Math.random();
                                    var val4 = Math.random();
                                    values[to.toISOString()] = {avg: val, x: val2, y: val3, r: val4};
                                // }
                            } else {
                                var val1 = Math.random();
                                if (val1 < .5) {
                                    val1 = 1;
                                }
                                var val2 = (1 - val1) / 2;
                                var val3 = (1 - val1) / 2;
                                var to = new Date(from.valueOf() + 1000*60*k);
                                values[to.toISOString()] = {state1: val1, state2: val2, state3: val3};
                            }
                        } 
                    }
                }

                var lines = {};
                data.push({[`Factory3`]: lines});
                for(var j = 0; j < 3; j++){
                    var values = {};
                    lines[`Station${j}`] = values;
                    for(var k = 0; k < 59; k++){
                        var val1 = 1; 
                        var val2 = 0;
                        var val3 = 0;
                        if (j === 1) {
                            val1 = 0;
                            val2 = 1;
                            val3 = 0;
                        } 
                        if (j === 2) {
                            val1 = 0;
                            val2 = 0;
                            val3 = 1;
                        }
                        let previousTo = to;
                        var toLocal = new Date(from.valueOf() + 1000*60*k);
                        if (k === 0 || k === 40) {
                            values[toLocal.toISOString()] = {state1: val1, state2: val2, state3: val3};
                        } else if (k === 20){
                            values[toLocal.toISOString()] = null;
                        }

                    } 
                }

                to = new Date(from.valueOf() + 1000*60*60);
                let searchSpan = {
                    from: from.toISOString(),
                    to: to.toISOString(),
                    bucketSize: '1m'
                }


                // render the data in a chart
                var tsiClient = new TsiClient();
                var lineChart = new tsiClient.ux.LineChart(document.getElementById('chart1'));
                let valueMapping = {
                    state1: {
                        color: 'darkgray'
                    }, 
                    state2: {
                        color: 'blue'
                    },
                    state3: {
                        color:'lightgray'
                    }
                }
                lineChart.render(data, {theme: 'light', tooltip: 'true'}, [{dataType: 'numeric', searchSpan: searchSpan}, {dataType: 'categorical', valueMapping: valueMapping, height: 100}, {dataType: 'numeric', searchSpan: searchSpan}, {dataType: 'categorical', valueMapping: valueMapping, height: 50}]);
            };
        </script>
    </body>
</html>